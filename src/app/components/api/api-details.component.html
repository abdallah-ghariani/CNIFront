<div class="card">
  <div class="container mx-auto p-5 bg-gray-50 min-h-screen">
    <!-- Back button with rounded style -->    
    <div class="pt-6 pb-2 px-6 max-w-6xl mx-auto">
      <button (click)="goBackToApis()" class="inline-flex items-center justify-center rounded-full border border-blue-300 bg-white px-4 py-2 text-sm font-medium text-blue-600 shadow-sm hover:bg-blue-50 transition-colors">
        <i class="pi pi-arrow-left mr-2"></i>
        Back to APIs
      </button>
    </div>
    
    <div class="max-w-6xl mx-auto px-6">
      <div class="api-documentation" *ngIf="api">
        <!-- Hero section with API info and access request card -->
        <div class="hero-section p-6 rounded-xl mb-6 relative overflow-hidden">
    <div class="absolute top-0 right-0 w-full h-full bg-blue-500 z-0"></div>
    
    <div class="relative z-10 flex justify-between items-start">
      <div class="text-white">
        <div class="flex items-center mb-2">
          <span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-sm font-medium mr-2 backdrop-blur-sm">
            API
          </span>
          <span class="bg-white bg-opacity-20 text-white px-3 py-1 rounded-full text-sm font-medium backdrop-blur-sm">
            v{{ api.version || '1' }}
          </span>
        </div>
        <h1 class="text-3xl font-bold mb-3">{{ api.name }}</h1>
        
        <div class="flex flex-wrap gap-3 mt-2">
          <span class="bg-white bg-opacity-25 text-white px-4 py-2 rounded-full text-sm font-medium flex items-center backdrop-blur-sm">
            <i class="pi pi-sitemap mr-2"></i> Structure: {{ getStructureName(api.structure) }}
          </span>
          <span class="bg-white bg-opacity-25 text-white px-4 py-2 rounded-full text-sm font-medium flex items-center backdrop-blur-sm">
            <i class="pi pi-tag mr-2"></i> Sector: {{ getServiceName(api.secteur) }}
          </span>
          <span class="bg-white bg-opacity-25 text-white px-4 py-2 rounded-full text-sm font-medium flex items-center backdrop-blur-sm">
            <i class="pi pi-clock mr-2"></i> Updated {{ api.updatedAt | date:'MMM d, yyyy, h:mm:ss a' }}
          </span>
        </div>
      </div>
      
      <!-- Request Access Card -->
      <div class="bg-white rounded-lg shadow p-5 w-72">
        <div class="text-center">
          <div class="bg-blue-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3">
            <i class="pi pi-search text-blue-600 text-xl"></i>
          </div>
          <h3 class="text-gray-800 font-semibold mb-2">Request API Access</h3>
          <p class="text-gray-600 text-sm mb-4">Request access to this API for your applications</p>
          <button (click)="activeTabIndex = 1" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded transition-colors flex items-center justify-center">
            <i class="pi pi-share-alt mr-2"></i> Request Access
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- API Documentation Tabs -->
  <p-tabView [(activeIndex)]="activeTabIndex">
    <!-- Endpoints Tab -->
    <p-tabPanel header="Endpoints" id="endpoints">
      <div class="grid">
        <!-- Endpoint List -->
        <div class="col-12 md:col-4 lg:col-3">
          <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-100">
            <div class="bg-gray-50 p-4 border-b border-gray-200">
              <h3 class="font-medium text-gray-700">Available Endpoints</h3>
              <p class="text-sm text-gray-500 mt-1">Select an endpoint to view details</p>
            </div>
            
            <div class="endpoint-list max-h-[500px] overflow-y-auto p-2">
              <div *ngFor="let endpoint of endpointList" 
                   class="endpoint-item p-3 mb-2 rounded-lg hover:bg-blue-50 cursor-pointer transition-all duration-200 border border-transparent hover:border-blue-200"
                   [class.selected-endpoint]="selectedEndpoint === endpoint"
                   (click)="selectedEndpoint = endpoint">
                <div class="flex items-center">
                  <span class="method-badge px-3 py-1 rounded text-white text-xs font-bold min-w-16 text-center" [ngClass]="{
                    'bg-green-600': endpoint.method === 'GET',
                    'bg-blue-600': endpoint.method === 'POST',
                    'bg-orange-500': endpoint.method === 'PUT',
                    'bg-red-600': endpoint.method === 'DELETE',
                    'bg-purple-600': endpoint.method === 'PATCH'
                  }">{{ endpoint.method }}</span>
                  <span class="ml-3 text-sm font-medium text-gray-900 truncate">{{ endpoint.path.split('/').pop() }}</span>
                </div>
                <p class="text-xs text-gray-600 mt-2 pl-16">{{ endpoint.description }}</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Endpoint Details -->
        <div class="col-12 md:col-8 lg:col-9">
          <!-- No Endpoint Selected State -->
          <div *ngIf="!selectedEndpoint" class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-100 p-8">
            <div class="text-center mb-6">
              <img src="assets/endpoint.svg" alt="Select an endpoint" class="w-16 h-16 mx-auto mb-4" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIzMiIgY3k9IjMyIiByPSIzMiIgZmlsbD0iI0YzRjRGNiIvPjxwYXRoIGQ9Ik0zMiAzMm0tMTYgMGExNiAxNiAwIDAxMzIgMG0tMzIgMGExNiAxNiAwIDAwMzIgMCIgc3Ryb2tlPSIjQTFBMUM5IiBzdHJva2Utd2lkdGg9IjIiLz48cGF0aCBkPSJNMjMgMzJoMThtLTEwIDJsNCA1bTYtNWwtNCA1IiBzdHJva2U9IiM2NTY1QUUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PC9zdmc+';" />
              <h2 class="text-xl font-bold text-gray-800 mb-2">No Endpoint Selected</h2>
              <p class="text-gray-600">Please select an endpoint from the list to view its details.</p>
            </div>
            
            <div class="border-t border-gray-200 pt-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">API Information</h3>
              
              <div class="grid grid-cols-1 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg">
                  <h4 class="font-medium text-gray-700 mb-2">Base Endpoint</h4>
                  <div class="bg-white p-3 rounded border border-gray-200 font-mono text-sm overflow-x-auto">
                    {{ api.baseUrl || 'https://api.example.com/v1' }}
                  </div>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg">
                  <h4 class="font-medium text-gray-700 mb-2">API Version</h4>
                  <div class="bg-white p-3 rounded border border-gray-200 font-mono text-sm">
                    v{{ api.version || '1' }}
                  </div>
                </div>
                
                <div *ngIf="api.documentation" class="bg-gray-50 p-4 rounded-lg">
                  <h4 class="font-medium text-gray-700 mb-2">Documentation</h4>
                  <div class="bg-white p-3 rounded border border-gray-200 font-mono text-sm overflow-x-auto">
                    <a [href]="api.documentation" target="_blank" class="text-blue-600 hover:text-blue-800 transition-colors">
                      {{ api.documentation }}
                      <i class="pi pi-external-link ml-1 text-xs"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div *ngIf="selectedEndpoint" class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-100 animate__animated animate__fadeIn">
            <!-- Endpoint Header -->
            <div class="border-b border-gray-200 bg-gray-50 p-5">
              <div class="flex items-center">
                <span class="method-badge px-3 py-1 rounded text-white text-xs font-bold" [ngClass]="{
                  'bg-green-600': selectedEndpoint.method === 'GET',
                  'bg-blue-600': selectedEndpoint.method === 'POST',
                  'bg-orange-500': selectedEndpoint.method === 'PUT',
                  'bg-red-600': selectedEndpoint.method === 'DELETE',
                  'bg-purple-600': selectedEndpoint.method === 'PATCH'
                }">{{ selectedEndpoint.method }}</span>
                <h2 class="text-xl font-bold text-gray-800 ml-3">{{ selectedEndpoint.description }}</h2>
              </div>
              
              <!-- API URL with copy button -->
              <div class="mt-4 flex items-center bg-gray-100 p-3 rounded-md font-mono text-sm group relative overflow-hidden">
                <div class="overflow-x-auto w-full whitespace-nowrap pr-10">
                  <span [ngClass]="{
                    'text-green-600': selectedEndpoint.method === 'GET',
                    'text-blue-600': selectedEndpoint.method === 'POST',
                    'text-orange-500': selectedEndpoint.method === 'PUT',
                    'text-red-600': selectedEndpoint.method === 'DELETE',
                    'text-purple-600': selectedEndpoint.method === 'PATCH'
                  }">{{ selectedEndpoint.method }}</span>
                  <span class="text-gray-700"> {{ selectedEndpoint.path }}</span>
                </div>
                <button class="absolute right-0 top-0 bottom-0 px-3 bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors" title="Copy to clipboard">
                  <i class="pi pi-copy"></i>
                </button>
              </div>
            </div>
            
            <div class="p-5">
              <!-- Path Parameters -->
              <div class="mb-8" *ngIf="selectedEndpoint.parameters && selectedEndpoint.parameters.length > 0">
                <div class="flex items-center mb-4">
                  <i class="pi pi-sliders-h text-blue-500 mr-2"></i>
                  <h3 class="text-lg font-semibold text-gray-800">Path Parameters</h3>
                </div>
                
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Parameter</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Required</th>
                      </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                      <tr *ngFor="let param of selectedEndpoint.parameters" class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600 font-mono">{{ param.name }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ param.value }}</td>
                        <td class="px-6 py-4 text-sm text-gray-500">{{ param.description }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                          <span *ngIf="param.required" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                            Required
                          </span>
                          <span *ngIf="!param.required" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                            Optional
                          </span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              
              <!-- Authorization -->
              <div class="mb-8" *ngIf="selectedEndpoint.requiresAuth">
                <div class="flex items-center mb-4">
                  <i class="pi pi-lock text-blue-500 mr-2"></i>
                  <h3 class="text-lg font-semibold text-gray-800">Authentication Required</h3>
                </div>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                  <div class="flex">
                    <div class="flex-shrink-0">
                      <i class="pi pi-info-circle text-blue-600"></i>
                    </div>
                    <div class="ml-3">
                      <p class="text-sm text-blue-800">
                        This endpoint requires authentication using one of the following methods:
                        <span *ngFor="let method of selectedEndpoint.authMethods; let last = last" class="font-medium">
                          {{ method }}<span *ngIf="!last">, </span>
                        </span>
                      </p>
                      <p class="mt-2 text-sm text-blue-700">
                        <a (click)="activeTabIndex = 1" class="font-medium underline cursor-pointer">Request access</a> to get your API credentials.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Response -->
              <div class="mb-6">
                <div class="flex items-center mb-4">
                  <i class="pi pi-reply text-blue-500 mr-2"></i>
                  <h3 class="text-lg font-semibold text-gray-800">Response Codes</h3>
                </div>
                
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status Code</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Resource</th>
                      </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                      <tr *ngFor="let response of selectedEndpoint.responses" class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium font-mono" 
                                [ngClass]="{
                                  'bg-green-100 text-green-800': response.statusCode.startsWith('2'),
                                  'bg-yellow-100 text-yellow-800': response.statusCode.startsWith('3'),
                                  'bg-red-100 text-red-800': response.statusCode.startsWith('4') || response.statusCode.startsWith('5')
                                }">
                            {{ response.statusCode }}
                          </span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-500">{{ response.description }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-blue-600 font-mono">{{ response.resource }}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              
              <!-- Example Usage Section -->
              <div class="mt-8">
                <div class="flex items-center mb-4">
                  <i class="pi pi-code text-blue-500 mr-2"></i>
                  <h3 class="text-lg font-semibold text-gray-800">Example Request</h3>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-4 text-white font-mono text-sm overflow-x-auto relative group">
                  <pre *ngIf="selectedEndpoint.method === 'GET'">curl -X GET \
  "{{ selectedEndpoint.path }}" \
  -H "Authorization: Bearer YOUR_API_KEY"</pre>
                  
                  <pre *ngIf="selectedEndpoint.method === 'POST'">curl -X POST \
  "{{ selectedEndpoint.path }}" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '&#123;
    "example": "data"
  &#125;'</pre>
                  
                  <pre *ngIf="selectedEndpoint.method === 'PUT'">curl -X PUT \
  "{{ selectedEndpoint.path }}" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '&#123;
    "id": "example-id",
    "updated": "data"
  &#125;'</pre>
                  
                  <pre *ngIf="selectedEndpoint.method === 'DELETE'">curl -X DELETE \
  "{{ selectedEndpoint.path }}" \
  -H "Authorization: Bearer YOUR_API_KEY"</pre>
                  
                  <button class="absolute right-2 top-2 bg-gray-700 hover:bg-gray-600 text-gray-300 p-1.5 rounded invisible group-hover:visible transition-all" title="Copy code">
                    <i class="pi pi-copy"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- No endpoint selected state -->
          <div *ngIf="!selectedEndpoint" class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-100 p-8 text-center">
            <img src="assets/images/select-endpoint.svg" alt="Select an endpoint" class="w-32 h-32 mx-auto mb-4 opacity-60">
            <h3 class="text-xl font-semibold text-gray-800 mb-2">No Endpoint Selected</h3>
            <p class="text-gray-600">Please select an endpoint from the list to view its details.</p>
          </div>
        </div>
      </div>
    </p-tabPanel>
    
    <!-- API Request Access Tab -->
    <p-tabPanel header="Request Access">
      <div class="grid">
        <!-- API Request Form -->
        <div class="col-12 lg:col-8 lg:col-offset-2 md:col-10 md:col-offset-1">
          <!-- Access Request Card -->  
          <div class="bg-white shadow-lg rounded-xl overflow-hidden border border-gray-100">
            <!-- Card Header -->  
            <div class="bg-gradient-to-r from-indigo-600 to-blue-500 p-5 text-white">
              <div class="flex items-center">
                <i class="pi pi-key text-2xl mr-4 bg-white bg-opacity-20 p-3 rounded-full"></i>
                <div>
                  <h3 class="text-xl font-bold">Request Access</h3>
                  <p class="text-indigo-100 mt-1">Submit a request to use {{ api ? api.name : 'this API' }}</p>
                </div>
              </div>
            </div>
            
            <div class="p-6">
              <!-- Success Message -->
              <div *ngIf="requestSent" class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6 animate__animated animate__fadeIn">
                <div class="flex">
                  <div class="flex-shrink-0 bg-green-100 rounded-full p-2">
                    <i class="pi pi-check-circle text-green-600 text-xl"></i>
                  </div>
                  <div class="ml-4">
                    <h3 class="text-lg font-medium text-green-800">Request Submitted Successfully</h3>
                    <div class="mt-2 text-green-700">
                      <p>Your request to access this API has been submitted and is awaiting approval.</p>
                      <p class="mt-2">You will be redirected to your API requests page shortly where you can track the status of your request.</p>
                    </div>
                    <div class="mt-4 flex">
                      <i class="pi pi-info-circle text-blue-500 mr-2"></i> 
                      <p class="text-sm text-blue-600">The approval process typically takes 1-2 business days.</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Error Message -->
              <div *ngIf="errorMessage" class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 animate__animated animate__fadeIn">
                <div class="flex">
                  <div class="flex-shrink-0 bg-red-100 rounded-full p-2">
                    <i class="pi pi-times-circle text-red-600 text-xl"></i>
                  </div>
                  <div class="ml-4">
                    <h3 class="text-lg font-medium text-red-800">Request Failed</h3>
                    <div class="mt-2 text-red-700">
                      <p>{{ errorMessage }}</p>
                    </div>
                    <div class="mt-4">
                      <button type="button" class="text-red-600 hover:text-red-800 font-medium flex items-center" (click)="resetForm()">
                        <i class="pi pi-refresh mr-2"></i> Try Again
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Request Process Steps -->
              <div *ngIf="!requestSent && !errorMessage" class="mb-6 hidden md:block">
                <div class="flex justify-between">
                  <div class="flex flex-col items-center">
                    <div class="bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center">
                      <i class="pi pi-file-edit"></i>
                    </div>
                    <div class="text-sm text-gray-600 mt-2">Submit Request</div>
                  </div>
                  <div class="flex-1 border-t-2 border-dashed border-gray-300 self-center mx-2"></div>
                  <div class="flex flex-col items-center">
                    <div class="bg-gray-200 text-gray-500 w-8 h-8 rounded-full flex items-center justify-center">
                      <i class="pi pi-clock"></i>
                    </div>
                    <div class="text-sm text-gray-400 mt-2">Approval Process</div>
                  </div>
                  <div class="flex-1 border-t-2 border-dashed border-gray-300 self-center mx-2"></div>
                  <div class="flex flex-col items-center">
                    <div class="bg-gray-200 text-gray-500 w-8 h-8 rounded-full flex items-center justify-center">
                      <i class="pi pi-key"></i>
                    </div>
                    <div class="text-sm text-gray-400 mt-2">API Access</div>
                  </div>
                </div>
              </div>
              
              <!-- Form -->
              <form [formGroup]="requestForm" (ngSubmit)="submitAccessRequest()" *ngIf="!requestSent" class="mt-8">
                <!-- API Information Card -->
                <div class="mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
                  <h4 class="font-medium text-gray-800 mb-3 flex items-center">
                    <i class="pi pi-info-circle text-blue-500 mr-2"></i> API Information
                  </h4>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="bg-white p-3 rounded border border-gray-100">
                      <span class="text-gray-500 block mb-1">Name:</span> 
                      <span class="font-medium text-gray-800">{{ api ? api.name : 'N/A' }}</span>
                    </div>
                    <div class="bg-white p-3 rounded border border-gray-100">
                      <span class="text-gray-500 block mb-1">Version:</span> 
                      <span class="font-medium text-gray-800">{{ api && api.version || 'v1' }}</span>
                    </div>
                    <div class="bg-white p-3 rounded border border-gray-100">
                      <span class="text-gray-500 block mb-1">Provider:</span> 
                      <span class="font-medium text-gray-800">{{ getStructureName(api && api.structure ? api.structure : '') }}</span>
                    </div>
                    <div class="bg-white p-3 rounded border border-gray-100">
                      <span class="text-gray-500 block mb-1">Sector:</span> 
                      <span class="font-medium text-gray-800">{{ getServiceName(api && api.secteur ? api.secteur : '') }}</span>
                    </div>
                  </div>
                </div>
                
                <!-- Purpose Field with better UI -->
                <div class="mb-6">
                  <label for="purpose" class="block text-sm font-medium text-gray-700 mb-1">
                    Purpose <span class="text-red-500">*</span>
                  </label>
                  <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                      <i class="pi pi-pencil text-gray-400"></i>
                    </div>
                    <input type="text" id="purpose" formControlName="purpose"
                           class="w-full pl-10 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all"
                           placeholder="Why do you need access to this API?">
                  </div>
                  <div *ngIf="requestForm.get('purpose')?.invalid && requestForm.get('purpose')?.touched" 
                       class="text-red-500 text-sm mt-1 flex items-center">
                    <i class="pi pi-exclamation-circle mr-1"></i>
                    Please provide a clear purpose for your request (at least 10 characters)
                  </div>
                  <div class="text-xs text-gray-500 mt-2">
                    Explain how you plan to use this API in your applications or services.
                  </div>
                </div>
                
                <!-- Submit Button and Additional Info -->
                <div class="mt-8 border-t border-gray-200 pt-6">
                  <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="mb-4 md:mb-0 md:mr-6">
                      <p class="text-sm text-gray-600">
                        <i class="pi pi-info-circle text-blue-500 mr-1"></i>
                        Your request will be reviewed by the API provider within 1-2 business days.
                      </p>
                    </div>
                    <div class="flex space-x-3">
                      <button type="button" pButton pRipple
                              class="p-button-outlined p-button-secondary"
                              (click)="resetForm()">
                        Cancel
                      </button>
                      <button type="submit" pButton pRipple
                              class="p-button-primary"
                              [disabled]="requestForm.invalid || submitting">
                        <i class="pi pi-send mr-2"></i>
                        {{ submitting ? 'Submitting...' : 'Submit Request' }}
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </p-tabPanel>
    
    <!-- Test API Tab -->
    <p-tabPanel header="Test API" id="testapi">
      <div class="grid">
        <div class="col-12">
          <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-100 p-5">
            <!-- Tab Content Header -->
            <div class="border-b border-gray-200 pb-4 mb-5">
              <h2 class="text-xl font-bold text-gray-800">Test API Endpoint</h2>
              <p class="text-gray-600 mt-1">Enter parameters and test this API's functionality</p>
            </div>
            
            <!-- Access Warning -->
            <div *ngIf="!userHasApiAccess" class="bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-md p-4 mb-4">
              <div class="flex">
                <div class="flex-shrink-0">
                  <i class="pi pi-exclamation-triangle text-yellow-600"></i>
                </div>
                <div class="ml-3">
                  <h3 class="text-sm font-medium">Access Required</h3>
                  <p class="text-sm mt-1">You need to request access to this API before you can test it. Go to the "Request Access" tab to submit a request.</p>
                </div>
              </div>
            </div>
            
            <!-- Test Form -->
            <div class="mb-4">
              <label for="testParams" class="block text-sm font-medium text-gray-700 mb-1">Parameters</label>
              <textarea 
                id="testParams" 
                [(ngModel)]="testApiParams" 
                rows="5" 
                class="w-full border border-gray-300 rounded-md p-2 font-mono text-sm"
                placeholder="{&#10;  &quot;param1&quot;: &quot;value1&quot;,&#10;  &quot;param2&quot;: &quot;value2&quot;&#10;}"
                [disabled]="!userHasApiAccess || isTestLoading"></textarea>
              <p class="text-xs text-gray-500 mt-1">Enter JSON parameters for your API test</p>
            </div>
            
            <!-- Submit Button -->
            <div class="mb-6">
              <button 
                pButton 
                type="button" 
                label="Test API" 
                icon="pi pi-play" 
                class="p-button-primary" 
                [disabled]="!userHasApiAccess || isTestLoading"
                [loading]="isTestLoading"
                (click)="testApi()">
              </button>
            </div>
            
            <!-- Response Area -->
            <div *ngIf="testApiResponse || testError" class="mt-6">
              <h3 class="text-base font-medium text-gray-700 mb-2">Response</h3>
              
              <!-- Error Display -->
              <div *ngIf="testError" class="bg-red-50 border border-red-200 text-red-800 rounded-md p-4 mb-4">
                <div class="flex">
                  <div class="flex-shrink-0">
                    <i class="pi pi-times-circle text-red-600"></i>
                  </div>
                  <div class="ml-3">
                    <h3 class="text-sm font-medium">Error</h3>
                    <p class="text-sm mt-1">{{ testError }}</p>
                  </div>
                </div>
              </div>
              
              <!-- Success Response Display -->
              <div *ngIf="testApiResponse" class="bg-gray-50 border border-gray-200 rounded-md p-4">
                <pre class="whitespace-pre-wrap font-mono text-sm text-gray-800 overflow-auto max-h-96">{{ testApiResponse }}</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </p-tabPanel>
  </p-tabView>

      </div>
      
      <div *ngIf="!api" class="bg-white rounded-lg shadow-sm p-8 text-center">
        <i class="pi pi-spin pi-spinner text-3xl text-blue-500 mr-3"></i>
        <span>Loading API details...</span>
      </div>
    </div>
  </div>
</div>

<!-- API Access Request Form Section removed as requested -->
